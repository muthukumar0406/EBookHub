<div class="reader-container" *ngIf="pdfSrc || safeUrl">
    <div class="reader-header">
        <button routerLink="/library" class="back-btn">
            <span>←</span> Back to Library
        </button>
        <h3>{{ book?.title }}</h3>
    </div>

    <!-- PDF Viewer -->
    <ngx-extended-pdf-viewer *ngIf="fileType === 'pdf'" [src]="pdfSrc" height="90vh">
    </ngx-extended-pdf-viewer>

    <!-- HTML or Other files in Iframe -->
    <iframe *ngIf="fileType !== 'pdf'" [src]="safeUrl" width="100%" height="90vh" frameborder="0">
    </iframe>
</div>

<div *ngIf="!pdfSrc && !safeUrl && !errorMessage" class="loading">
    <div class="loading-spinner"></div>
    <p>Loading book...</p>
    <p class="debug-hint" style="font-size: 0.8rem; opacity: 0.6; margin-top: 2rem;">
        Trying to fetch book ID: {{ bookId }}
    </p>
</div>

<div *ngIf="errorMessage" class="error-container">
    <p>⚠️ {{ errorMessage }}</p>
    <button (click)="ngOnInit()" class="btn-primary">Retry</button>
    <button routerLink="/library" class="btn-secondary">Back to Library</button>
</div>