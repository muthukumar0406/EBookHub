<div class="reader-container" *ngIf="safeUrl">
    <div class="reader-header">
        <div class="header-left">
            <button [routerLink]="['/library']" class="back-btn">
                <span class="icon">←</span>
                <span>Library</span>
            </button>
        </div>
        <div class="header-center">
            <h3>{{ book?.title }}</h3>
        </div>
        <div class="header-right">
            <span class="file-badge">{{ fileType }}</span>
        </div>
    </div>

    <div class="viewer-wrapper">
        <div class="iframe-container">
            <iframe [src]="safeUrl" width="100%" height="100%" frameborder="0" allowfullscreen>
            </iframe>
        </div>
    </div>
</div>

<div *ngIf="isLoading && !errorMessage" class="loading-state">
    <div class="spinner"></div>
    <h3>Opening Book</h3>
    <p>Please wait while we prepare your reader...</p>
</div>

<div *ngIf="errorMessage" class="error-state">
    <div class="error-card glass">
        <span class="error-icon">⚠️</span>
        <h2>Reader Error</h2>
        <p>{{ errorMessage }}</p>
        <div class="error-actions">
            <button (click)="ngOnInit()" class="btn-primary">Try Again</button>
            <button [routerLink]="['/library']" class="btn-secondary">Back to Library</button>
        </div>
    </div>
</div>